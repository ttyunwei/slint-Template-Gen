# slint-Template-Gen
Generate slint template file project directory

## 编译
```bash
cargo build --release
```

## 使用
```bash
slint-run <Your project directory>
```

## 源代码
```rust
use std::{
    env,
    fs::{self, File},
    io::Write,
    path::Path,
};

fn main() -> Result<(), Box<dyn std::error::Error>> {
    let args: Vec<String> = env::args().collect();
    let project_name = args.get(1).ok_or("Missing project name argument")?;

    // 创建项目根目录
    fs::create_dir_all(project_name)?;

    // 创建子目录结构
    create_dir_structure(project_name)?;

    // 生成所有文件
    generate_files(project_name)?;

    println!("Successfully created Slint project: {}", project_name);
    Ok(())
}

fn create_dir_structure(project_name: &str) -> std::io::Result<()> {
    fs::create_dir_all(format!("{}/.vscode", project_name))?;
    fs::create_dir_all(format!("{}/src", project_name))?;
    fs::create_dir_all(format!("{}/ui", project_name))?;
    Ok(())
}

fn generate_files(project_name: &str) -> Result<(), Box<dyn std::error::Error>> {
    // .gitignore
    create_file(&format!("{}/.gitignore", project_name), GITIGNORE)?;

    // build.rs
    create_file(&format!("{}/build.rs", project_name), BUILD_RS)?;

    // Cargo.toml
    let cargo_toml = CARGO_TOML.replace("{}", project_name);
    create_file(&format!("{}/Cargo.toml", project_name), &cargo_toml)?;

    // VSCode 配置
    create_file(&format!("{}/.vscode/extensions.json", project_name), VSCODE_EXTENSIONS)?;
    create_file(&format!("{}/.vscode/settings.json", project_name), VSCODE_SETTINGS)?;

    // Rust 主文件
    create_file(&format!("{}/src/main.rs", project_name), MAIN_RS)?;

    // Slint UI 文件
    create_file(&format!("{}/ui/app-window.slint", project_name), SLINT_FILE)?;

    Ok(())
}

fn create_file(path: &str, content: &str) -> std::io::Result<()> {
    let path = Path::new(path);
    if let Some(parent) = path.parent() {
        fs::create_dir_all(parent)?;
    }
    let mut file = File::create(path)?;
    file.write_all(content.as_bytes())?;
    Ok(())
}

// 文件模板
const GITIGNORE: &str = r#"# Generated by Cargo
# will have compiled files and executables
/target/

# Alternative VCS systems
/.jj/
/.hg/
/.pijul/

# These are backup files generated by rustfmt
**/*.rs.bk
"#;

const BUILD_RS: &str = r#"fn main() {
    slint_build::compile("ui/app-window.slint").expect("Slint build failed");
}
"#;

const CARGO_TOML: &str = r#"[package]
name = "{}"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
slint = "1.9.2"

[build-dependencies]
slint-build = "1.9.2"
"#;

const VSCODE_EXTENSIONS: &str = r#"{
    "recommendations": [
        "rust-lang.rust-analyzer",
        "vadimcn.vscode-lldb",
        "Slint.slint"
    ]
}
"#;

const VSCODE_SETTINGS: &str = r#"{
    "[rust]": {
        "editor.defaultFormatter": "rust-lang.rust-analyzer"
    }
}
"#;

const MAIN_RS: &str = r#"// Prevent console window in addition to Slint window in Windows release builds when, e.g., starting the app via file manager. Ignored on other platforms.
#![cfg_attr(not(debug_assertions), windows_subsystem = "windows")]

use std::error::Error;

slint::include_modules!();

fn main() -> Result<(), Box<dyn Error>> {
    let ui = AppWindow::new()?;

    ui.on_request_increase_value({
        let ui_handle = ui.as_weak();
        move || {
            let ui = ui_handle.unwrap();
            ui.set_counter(ui.get_counter() + 1);
        }
    });

    ui.run()?;

    Ok(())
}
"#;

const SLINT_FILE: &str = r#"import { Button, VerticalBox } from "std-widgets.slint";

export component AppWindow inherits Window {
    in-out property <int> counter: 101;
    callback request-increase-value();
    VerticalBox {
        Text {
            text: "Counter: \{root.counter}";
        }

        Button {
            text: "Increase value";
            clicked => {
                root.request-increase-value();
            }
        }
    }
}
"#;
```
